<p>checking if a task has failed in airflow is simple enough, and may be done with:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span><span class="w"> </span><span class="nn">airflow.operators.python</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_current_context</span>

<span class="nd">@task</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_task_failed</span><span class="p">(</span><span class="n">task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
      <span class="n">context</span> <span class="o">=</span> <span class="n">get_current_context</span><span class="p">()</span>
      <span class="k">return</span> <span class="p">(</span>
          <span class="n">context</span><span class="p">[</span><span class="s2">&quot;dag_run&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_task_instance</span><span class="p">(</span><span class="n">task_id</span><span class="o">=</span><span class="n">task_id</span><span class="p">)</span><span class="o">.</span><span class="n">state</span>
          <span class="o">==</span> <span class="n">State</span><span class="o">.</span><span class="n">FAILED</span>
      <span class="p">)</span>
</pre></div>

<p>however, if the task is nested within a <code>task_group</code>, referencing the task with <code>task_id</code> doesn't work.
in theory, tasks inside a <code>task_group</code> should be indexed with <code>group_id.task_id</code><sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>, but trying <code>get_task_instance</code>
with this ID structure will return a <code>NoneType</code>.</p>
<p>the one way i have found to actually make it work, is with the following:</p>
<div class="code"><pre class="code literal-block"><span class="kn">from</span><span class="w"> </span><span class="nn">airflow.operators.python</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_current_context</span>

<span class="nd">@task</span>
<span class="k">def</span><span class="w"> </span><span class="nf">check_task_failed</span><span class="p">(</span><span class="n">group_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">task_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
      <span class="n">context</span> <span class="o">=</span> <span class="n">get_current_context</span><span class="p">()</span>
      <span class="n">failed_tasks</span> <span class="o">=</span> <span class="n">context</span><span class="p">[</span><span class="s2">&quot;dag_run&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_task_instances</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">State</span><span class="o">.</span><span class="n">FAILED</span><span class="p">)</span>
      <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group_id</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">task_id</span><span class="si">}</span><span class="s2">&quot;</span> <span class="ow">in</span> <span class="p">{</span>
          <span class="n">ft</span><span class="o">.</span><span class="n">task_id</span> <span class="k">for</span> <span class="n">ft</span> <span class="ow">in</span> <span class="n">failed_tasks</span>
      <span class="p">}</span>
</pre></div>

<p>which i was able to implement based an answer on stackoverflow<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>.</p>
<p>before finding that answer, i struggled with missing docs, llm hallucinations. and what i am fairly sure were people posting llm bullshit as if it were real.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://www.astronomer.io/docs/learn/task-groups/" target="_blank">astronomer docs on <code>task_groups</code></a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="https://stackoverflow.com/questions/73740427/airflow-how-to-get-list-of-upstream-failed-tasks" target="_blank">the answer to my problems, thank you mati.o</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>